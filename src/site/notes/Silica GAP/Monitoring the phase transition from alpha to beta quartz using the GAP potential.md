---
{"dg-publish":true,"permalink":"/silica-gap/monitoring-the-phase-transition-from-alpha-to-beta-quartz-using-the-gap-potential/","dgHomeLink":true,"dgPassFrontmatter":false}
---


# Monitoring the phase transition from alpha to beta quartz using the GAP potential

We obtain the GAP potential files from the data accompanying the paper "Phase stability and phase transitions of silica from a machine-learned interatomic potential" from L. C. Erhard, J. Rohrer, K. Albe and V. L. Deringer (2021)"

This potential claims to have extraordinary accuracy on the silica energy landscape, examplified by the good agreement in the energy-volume relationship for all of the most common polymorphs: 

![[Pasted image 20221011215354.png | 300]]

The pressure-density function is also quite remarkable in that is captures the strain hardening to softening transition around 20 GPa. 

We create a silica block using `molecular-builder`. 

---
```python 
from molecular_builder import create_bulk_crystal, write

atoms = create_bulk_crystal("alpha_quartz", size=[20,20,20])

write(atoms, "alpha_quartz.data", atom_style="atomic")
```
---

Then we run a simulation using the QUIP-package in lammps. In this simulation, we steadily increase the temperature from 200 K to 1200 K over 10000 timesteps using a Langevin thermostat. The pressure is kept at 1 bar using tha nph barostat. 

---
```
units		metal
atom_style atomic
 
boundary	p p p

read_data alpha_quartz.data 

mass 		1 15.999
mass 		2 28.0855

pair_style	quip
pair_coeff  * * silica_gap.xml "Potential xml_label=GAP_2021_4_19_120_7_32_55_336" 8 14

thermo_style 	custom step temp pe press vol spcpu cpuremain

timestep 0.001 

thermo 1

dump 1 all custom 10 trajectory.bin id type x y z 

velocity all create 200.0 4928459 dist gaussian
fix langevin all langevin 200 1200 0.1 699483
fix nph all nph aniso 1 1 1.0

run 10000
```
---


The initial structure was alpha-quartz, so the starting frame looks like this:  
![[Pasted image 20221011155420.png | 400]]

---

At the end of the simluation, the structure has changed to this, which looks like beta quartz:   

![[Pasted image 20221011155537.png | 400]]

---
The whole transition can also be seen in a video. It is not obsious to a naked eye exactly when the transition happens (and in fact, the transision is gradual). 

<iframe width="300" height="300" src="https://www.youtube.com/embed/orS6nBzNkaQ" title="Transition from alpha to beta quarts in GAP potential MD simulation" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

To quantify the transition, we measure the O-Si-O bond angle in ovito. 

This can be done using the following script, that I generated by first setting up the analysis in the Ovito GUI, then exporting the pipeline ass python code, and finally editing the python code to make it export the output to file. 

```python 
from ovito.io import import_file
from ovito.modifiers import CreateBondsModifier, BondAnalysisModifier, TimeSeriesModifier
from ovito.data import DataCollection
import numpy as np

pipeline = import_file('/Users/henriasv/Dropbox/trajectory.bin', multiple_frames = True)

mod = CreateBondsModifier()
mod.mode = CreateBondsModifier.Mode.Pairwise
pipeline.modifiers.append(mod)
mod.set_pairwise_cutoff(2, 1, 2.0)

pipeline.modifiers.append(BondAnalysisModifier(
    length_cutoff = 2.0, 
    bins = 1000, 
    partition = BondAnalysisModifier.Partition.ByParticleType))

def modify(frame: int, data: DataCollection):    
    xy = data.tables["bond-angle-distr"].xy()
    counts = xy[:,3]
    angles = xy[:,0]
    
    data.attributes['mean-angle'] = np.dot(counts, angles)/np.sum(counts)
    step = data.attributes['Timestep']
    
pipeline.modifiers.append(modify)

pipeline.modifiers.append(TimeSeriesModifier(
    operate_on = 'mean-angle', 
    time_attribute = 'Timestep'))

data = pipeline.compute()

data.tables['time-series'].xy().tofile("step_angle.npy")
```

The above code involves generating bonds using the CreateBondsModifier, analysing the bond angles using the BondAnalysisModifier and then using a custom python script modifier to compute the average O-Si-O bond angle, which is stored in the column with index 3 from the output array of BondAnalysisModofier. The values are stored as attributes and a time series is generated using the TimeSeriesModifier. 

We then plot the output by combining these computations with the temperature measurements from the log file. We add some smoothing to the temperature measurements. 

```python
import numpy as np
import matplotlib.pyplot as plt 
from lammps_logfile import File, running_mean

log = File("log.lammps")

step_log = log.get("Step")
temp_log = running_mean(log.get("Temp"), 100)

data = np.load("step_angle.npy")
step = data[:,0]

angle = data[:,1]
mask = np.isin(step_log, step)

plt.plot(temp_log[mask], angle)
plt.xlabel("Temperature (K)")
plt.ylabel("Angle (degrees)")
plt.show()
```

The plot is shown below. It indicates a full transition to beta quartz at around 700–800 Kelvin, or 427–527 degrees Celsius, in fair agreement with the experimental transition temperature of around 573 C. A more precise estimate requires slower heating to collect better statistics. 

![[Pasted image 20221011224054.png | 500]]

I have applied for and been granted 100 000 cpu hour equivalents of bigmem node computation time on Saga for training GAP potentials. Plan to use this for modeling silica–water systems trained on SCAN DFT energy calculations. 